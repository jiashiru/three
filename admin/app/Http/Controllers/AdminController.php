<?phpnamespace App\Http\Controllers;use App\Role;use App\Admin;use Illuminate\Http\Request;use Illuminate\Support\Facades\DB;class AdminController extends Controller{    public function show()    {        $roles = Admin::find(1)->roles()->get()->toArray();        dd($roles);die;        return view('admin.show');    }    public function add(Request $request)    {        $roleData = Role::all()->toArray();        if ($request->isMethod('POST')) {                $this->validate($request, [                'uname' => 'required|min:2|max:20',                'filename' => 'required',                'role_id' => 'required',                'password_confirmation'  => 'required|between:6,32',                'password'  => 'required|between:6,32|confirmed',            ],[                'required' => ':attribute 为必填项',                'min' => ':attribute 长度不符合要求',                'max' => ':attribute 长度不符合要求',            ],[                'uname' => '姓名',                'filename' => '头像',                'role_id' => '角色',                'password' => '密码',            ]);            $data = $request->input();//            dd(md5(md5($data['password'], true)));die;            $img = $request->file('filename');            if ($img->isValid()) {                //源文件名                $originalName = $img->getClientOriginalName();                $path = public_path('upload');                $img->move($path, $originalName);                $admin = new Admin();                $admin->admin_name = $data['uname'];                $admin->admin_photo = $originalName;                $admin->admin_password = md5(md5($data['password'], true));                if ($admin->save()) {                    foreach ($data['role_id'] as $val) {                        $admin_id = $admin->admin_id;                        DB::table('admin_role')->insert(['admin_id' => $admin_id, 'role_id' => $val]);                    }                    return redirect('adminShow')->with('success', '添加成功');                } else {                    return redirect('adminAdd')->with('error', '添加失败');                }            }        }        return view('admin.add', ['roleData' => $roleData]);    }}
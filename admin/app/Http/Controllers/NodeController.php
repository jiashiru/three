<?phpnamespace App\Http\Controllers;use App\Model\Node;use Illuminate\Http\Request;use DB;class NodeController extends CommonController{    //节点展示    public function show()    {        $nodes = Node::all()->toArray();        $node = new Node();        $nodeList = $node->nodeData($nodes, $parent_id = 0, $level = 0);        return view('node.show', ['nodeList' => $nodeList]);    }    //节点添加    public function add(Request $request)    {        $nodes = Node::all()->toArray();        $node = new Node();        $nodeList = $node->nodeData($nodes, $parent_id = 0, $level = 0);        if ($request->isMethod('POST')) {            $data = $request->input();            $admin = new Node();            $admin->node_title = $data['node_title'];            $admin->parent_id = $data['parent_id'];            $admin->route = $data['route'];            $admin->node_desc = $data['node_desc'];            if ($admin->save()) {                return redirect('nodeShow')->with('success', '添加成功');            } else {                return redirect('nodeAdd')->with('error', '添加失败');            }        }        return view('node.add', ['nodeList' => $nodeList]);    }    //节点删除    public function delete(Request $request)    {        $node_id = $request->get('id');        $bool = Node::where('node_id', '=', $node_id)->delete();        if ($bool) {            $bools = DB::table('role_node')->where('node_id', '=', $node_id)->delete();            if ($bools) {                return redirect('roleShow')->with('success', '删除成功');            } else {                return redirect('roleShow')->with('error', '删除失败');            }        } else {            return redirect('roleShow--')->with('error', '删除失败');        }    }}
$(function(){var b=false;var a=new Object();$.fn.initAreaFun=function(s){var h={AID:"selProvinceID",BID:"selCityID",CID:"selCountyID",DID:"selAddressID",AAreaID:0,BAreaID:0,CAreaID:0,DAreaID:0,AAreaName:"",BAreaName:"",CAreaName:"",DAreaName:"",ADefText:"---请选择---",BDefText:"---请选择---",CDefText:"---请选择---",DDefText:"---请选择---",Direction:'<s class="u-personal"></s>',CountyClickCallBack:function(t){},CompleteCallBack:function(t){}};s=s||{};$.extend(h,s);var l=function(v){var t="---请选择---";var u=v.attr("id");if(u==h.AID){t=h.ADefText}else{if(u==h.BID){t=h.BDefText}else{if(u==h.CID){t=h.CDefText}else{if(u==h.DID){t=h.DDefText}}}}return t};var r=function(A,B){var w=A.attr("id");var C=parseInt(A.attr("AreaID"));var u="";var t=B.regions;for(var x=0;x<t.length;x++){u+='<a href="javascript:;" AreaID='+t[x].id+" AreaName="+t[x].name+" Zip="+t[x].zip+">"+t[x].name+"</a>"}if(w==h.DID){if(t.length>0){n.show()}else{n.hide();n.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.DDefText)}}var v=$(u);v.bind("click",function(D){stopBubble(D);c(A,$(this));f(A,false,false);if(w==h.AID){o(e,$(this).attr("AreaID"),r)}else{if(w==h.BID){o(k,$(this).attr("AreaID"),r)}else{if(w==h.CID){o(n,$(this).attr("AreaID"),r);if($(this).attr("zip")!=""){h.CountyClickCallBack($(this).attr("zip"))}}}}});var z=$('<div class="select-state"></div>').append(v);A.append(z);if(C>0){var y=A.find("a[AreaID="+C+"]");y.addClass("hover");A.children("a").html(y.html()+h.Direction).attr("class","gray3")}h.CompleteCallBack(w)};var o=function(v,w,t){if(a["area_"+w]!=null&&typeof(a["area_"+w])!="undefined"){if(a["area_"+w]=="NoData"){var u=v.attr("id");if(u==h.AID){f(p,true,false)}else{if(u==h.BID){f(p,true,false)}else{if(u==h.CID){f(e,true,false)}else{if(u==h.DID){f(k,true,false)}}}}}else{t(v,a["area_"+w])}}else{$.ajax({type:"get",url:"/JPData",data:"action=getAreaChildNodes&areaID="+w,async:true,success:function(x){if(x!=null&&x.code==0){x=x.str;t(v,x);a["area_"+w]=x}else{if(x!=null&&x.code==1){var y=v.attr("id");if(y==h.AID){f(p,true,false)}else{if(y==h.BID){f(p,true,false)}else{if(y==h.CID){f(e,true,false)}else{if(y==h.DID){f(k,true,false)}}}}a["area_"+w]="NoData"}}},dataType:"json"})}};var f=function(w,u,v){if(parseInt(w.attr("AreaID"))>0){w.children("div.select-state").find('a[AreaID="0"]').remove()}var t=w.attr("id");if(t==h.AID){if(v){p.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.ADefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").children("a").removeClass("hover")}e.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.BDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").remove();k.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.CDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").remove();n.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.DDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").remove();if(u){e.hide;k.hide();n.hide()}}else{if(t==h.BID){if(v){e.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.BDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").children("a").removeClass("hover")}k.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.CDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").remove();n.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.DDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").remove();if(u){k.hide();n.hide()}}else{if(t==h.CID){if(v){k.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.CDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").children("a").removeClass("hover")}n.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.DDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").remove();if(u){n.hide()}}else{if(t==h.DID){if(v){n.removeClass("state-hover").attr("AreaID","0").attr("AreaName","").children("a").html(h.DDefText+h.Direction).attr("exp",0).attr("class","gray6").next("div.select-state").children("a").removeClass("hover")}}}}}};var c=function(v,u){if(u!=null){var t=l(v);var w=u.html()==t?"gray6":"gray3";u.addClass("hover").siblings().removeClass("hover");v.children("a").html(u.html()+h.Direction).attr("exp",0).attr("class",w);v.attr("AreaID",u.attr("AreaID")).attr("AreaName",u.html()).removeClass("state-hover")}else{v.removeClass("state-hover").children("a").attr("exp","0")}v.children("div.select-state").find('a[AreaID="0"]').remove()};var q=function(t){$("body").trigger("click");if(parseInt(t.attr("AreaID"))>0){var u=$('<a href="javascript:;" areaid="0">'+l(t).replace('<s class="u-personal"></s>',"")+"</a>");u.bind("click",function(){f(t,false,true)});t.children("div.select-state").children("a:first").before(u)}t.addClass("state-hover").children("a").attr("exp","1")};var i=$(this);var p=$("#"+h.AID,i).attr("AreaID",0).attr("AreaName","");var e=$("#"+h.BID,i).attr("AreaID",0).attr("AreaName","");var k=$("#"+h.CID,i).attr("AreaID",0).attr("AreaName","");var n=$("#"+h.DID,i).attr("AreaID",0).attr("AreaName","");p.children("a").unbind("click").bind("click",function(t){stopBubble(t);if($(this).attr("exp")=="1"){c(p,null)}else{q(p)}});e.children("a").unbind("click").bind("click",function(t){stopBubble(t);if(parseInt(p.attr("AreaID"))>0){if($(this).attr("exp")=="1"){c(e,null)}else{q(e)}}});k.children("a").unbind("click").bind("click",function(t){stopBubble(t);if(parseInt(e.attr("AreaID"))>0){if($(this).attr("exp")=="1"){c(k,null)}else{q(k)}}});n.children("a").unbind("click").bind("click",function(t){stopBubble(t);if(parseInt(k.attr("AreaID"))>0){if($(this).attr("exp")=="1"){c(n,null)}else{q(n)}}});$("body").bind("click",function(){c(p,null);c(e,null);c(k,null);c(n,null)});if(h.AAreaID>0){var j=parseInt(h.AAreaID);var d=parseInt(h.BAreaID);var m=parseInt(h.CAreaID);var g=parseInt(h.DAreaID);p.attr("AreaID",j).attr("AreaName",h.AAreaName);e.attr("AreaID",d).attr("AreaName",h.BAreaName);k.attr("AreaID",m).attr("AreaName",h.CAreaName);n.attr("AreaID",g).attr("AreaName",h.DAreaName);if(j>0){o(p,1,r);if(d>0){o(e,j,r);if(m>0){o(k,d,r);o(n,m,r)}}}}else{o(p,1,r)}}});function getSelelctAreaVal(a){var b="0";var c=$("#"+a);if(c.length>0){b=c.attr("AreaID")}return b}function getSelelctAreaText(a){var b="";var c=$("#"+a);if(c.length>0&&parseInt(c.attr("AreaID"))>0){if(c.attr("AreaName")!=""){b=c.attr("AreaName")}else{b=c.children("div.select-state").find("a[AreaID="+c.attr("AreaID")+"]").html()}}return b};
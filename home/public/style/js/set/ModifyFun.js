var CBLBirthdayFun=null;$(function(){var a="http://skin.1yyg.net";var b=function(){var H=function(J){var I=/^[\u4e00-\u9fa5]+$/;return I.test(J)};var g=function(J){var I=/^1\d{10}$/;return I.test(J)};var y=function(J){var I=/^(0[0-9]{2,3}\-)+([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/;return I.test(J)};var p=function(I){var K=/^[a-zA-Z0-9_\u4e00-\u9fa5\-]{2,20}$/;if(K.test(I)){var L=0;for(var J=0;J<I.length;J++){if(H(I[J])){L+=2}else{L+=1}}if(L>20){return false}}else{return false}return true};var B=function(J){var I=/^[0-9]{5,12}$/;return I.test(J)};var G=parseInt($("#hidSex").val());var s=$("div.sex-list");s.children("div.box").bind("click",function(){$(this).find(".box-check").addClass("current").parent().siblings().find(".box-check").removeClass("current")});if(G>0){s.find("div[value='"+G+"']").find(".box-check").addClass("current").parent().siblings().find(".box-check").removeClass("current")}var t=function(){var I=0;s.children("div.box").each(function(){if($(this).find(".box-check").hasClass("current")){I=$(this).attr("value");return false}});return I};var e=function(){var K=$("#sltCons");var L="";var M=["白羊座","金牛座","双子座","巨蟹座","狮子座","处女座","天秤座","天蝎座","射手座","摩羯座","水瓶座","双鱼座"];var I="";for(var J=1;J<=M.length;J++){I+='{"text":"'+M[J-1]+'","value":"'+J+'"},'}if(I!=""){I=I.substring(0,I.length-1);K.initSelectFun({Enabled:true,DefTxt:"-生日自动匹配-",DataSrouce:'{"data":['+I+"]}",Value:L})}};e();var h=function(){var L=$("#sltYear");var V=$("#sltMonth");var S=$("#sltDay");var Q=$("#hidBirthday").val().split("-");var R=-1,N=-1,U=-1;if(Q.length>2){if(parseInt(Q[0])>0){R=parseInt(Q[0])}if(parseInt(Q[1])>0){N=parseInt(Q[1])}if(parseInt(Q[2])>0){U=parseInt(Q[2])}}var K=false;var P=$("#hidUpdateTime").val();if(P!=""){K=true;var J=P.split("-");$("#span_tip").html((parseInt(J[0])+1)+"年"+J[1]+"月"+J[2]+"日后才能再次编辑您的生日")}var I=function(W){return(W%4==0||(W%100==0&&W%400==0))};var M=[31,28,31,30,31,30,31,31,30,31,30,31];this.initYear=function(){var Y=new Date().getFullYear()-5;var X="";for(var W=Y;W>Y-60;W--){X+='{"text":"'+W+'","value":"'+W+'"},'}X=X.substring(0,X.length-1);L.initSelectFun({Enabled:K,DefTxt:"年",DataSrouce:'{"data":['+X+"]}",Value:R,ClickCallBack:function(){CBLBirthdayFun.intiMonths(V.attr("value"))}});if(parseInt(V.attr("value"))>-1){CBLBirthdayFun.intiMonths(V.attr("value"))}else{CBLBirthdayFun.intiMonths(N)}};this.intiMonths=function(Y){var X="";var Z=parseInt(L.attr("value"));if(Z>-1){for(var W=1;W<=12;W++){X+='{"text":"'+W+'","value":"'+W+'"},'}X=X.substring(0,X.length-1);V.initSelectFun({Enabled:K,DefTxt:"月",DataSrouce:'{"data":['+X+"]}",Value:Y,ClickCallBack:function(){CBLBirthdayFun.initDays(S.attr("value"))}});if(parseInt(S.attr("value"))>-1){CBLBirthdayFun.initDays(S.attr("value"))}else{CBLBirthdayFun.initDays(U)}}};this.initDays=function(Z){var Y="";var ab=parseInt(L.attr("value"));var W=parseInt(V.attr("value"));if(ab>-1&&W>-1){var aa=M[W-1];if(W==2&&I(ab)){aa++}for(var X=1;X<=aa;X++){Y+='{"text":"'+X+'","value":"'+X+'"},'}Y=Y.substring(0,Y.length-1);S.initSelectFun({Enabled:K,DefTxt:"日",DataSrouce:'{"data":['+Y+"]}",Value:Z,ClickCallBack:function(){O(W,parseInt(S.attr("value")))}});O(W,Z)}};function T(X,Y){var W=new Array(31,28,31,30,31,30,31,31,30,31,30,31);if(Y==2){if((X%4==0&&X%100!=0)||X%400==0||X<1900){return 29}else{return W[Y-1]}}else{return W[Y-1]}}var O=function(Z,Y){Z=parseInt(Z,10);Y=parseInt(Y,10);var aa="0";if((Z==12&&Y>=22)||(Z==1&&Y<=20)){aa="10";"魔羯座"}else{if((Z==1&&Y>=21)||(Z==2&&Y<=19)){aa="11";"水瓶座"}else{if((Z==2&&Y>=20)||(Z==3&&Y<=20)){aa="12";"双鱼座"}else{if((Z==3&&Y>=21)||(Z==4&&Y<=20)){aa="1"}else{if((Z==4&&Y>=21)||(Z==5&&Y<=21)){aa="2";"金牛座"}else{if((Z==5&&Y>=22)||(Z==6&&Y<=21)){aa="3"}else{if((Z==6&&Y>=22)||(Z==7&&Y<=22)){aa="4"}else{if((Z==7&&Y>=23)||(Z==8&&Y<=23)){aa="5"}else{if((Z==8&&Y>=24)||(Z==9&&Y<=23)){aa="6"}else{if((Z==9&&Y>=24)||(Z==10&&Y<=23)){aa="7"}else{if((Z==10&&Y>=24)||(Z==11&&Y<=22)){aa="8"}else{if((Z==11&&Y>=23)||(Z==12&&Y<=21)){aa="9"}}}}}}}}}}}}var X=$("#sltCons");var W=X.children("div.select-state").find("a[value="+aa+"]");if(W.length>0){X.attr("value",aa);W.addClass("hover").siblings().removeClass("hover");X.children("a").attr("class","gray9").attr("style","cursor:default").html(W.html()+'<s class="u-personal"></s>')}}};CBLBirthdayFun=new h();CBLBirthdayFun.initYear();var c=$("#hidLiveA").val();var u=$("#hidLiveB").val();$("#div_live").initAreaFun({AID:"selLiveA",BID:"selLiveB",AAreaID:c,BAreaID:u});var r=$("#hidHomeA").val();var d=$("#hidHomeB").val();$("#div_home").initAreaFun({AID:"selHomeA",BID:"selHomeB",AAreaID:r,BAreaID:d});var i=function(){var L=$("#selMonthIncome");var M=$("#hidMonthIncome").val();var J=["1000以下","1000-3000","3000-5000","5000-10000","10000以上"];var I="";for(var K=1;K<=J.length;K++){I+='{"text":"'+J[K-1]+'","value":"'+J[K-1]+'"},'}if(I!=""){I=I.substring(0,I.length-1);L.initSelectFun({DataSrouce:'{"data":['+I+"]}",Value:M})}};i();var m=$("#txtName");var z=$("#txtPhone");var o=$("#txtQQ");var x=$("#txtSignature");var E=$("#btnSave");var C="";var k="手机号/座机";var l="您的QQ号码";var f="让别人看到不一样的你";var F="#333333",v="#bbbbbb";m.focus(function(){if($(this).val().trim()==C){$(this).val("")}$(this).css("color",F)}).blur(function(){var I=$(this).val().trim();if(I==""){D(m,"昵称为2-20个字符，汉字、字母、数字、“_-”组成")}else{if(!p(I)){D(m,"昵称为2-20个字符，汉字、字母、数字、“_-”组成")}else{w($(this))}}}).keyup(function(){var I=$(this).val().trim();if(I!=""&&I!=C){if(!p(I)){D(m,"昵称为2-20个字符，汉字、字母、数字、“_-”组成")}else{w($(this))}}});if(m.val().trim()!=""&&m.val().trim()!=C){m.css("color",F)}z.focus(function(){if($(this).val().trim()==k){$(this).val("")}$(this).css("color",F)}).blur(function(){if($(this).val().trim()==""||$(this).val().trim()==k){if($(this).val().trim()==""){$(this).val(k)}$(this).css("color",v)}});if(z.val().trim()!=""&&z.val().trim()!=k){z.css("color",F)}o.focus(function(){if($(this).val().trim()==l){$(this).val("")}$(this).css("color",F)}).blur(function(){$(this).parent().removeClass("f-focus");if($(this).val().trim()==""||$(this).val().trim()==l){if($(this).val().trim()==""){$(this).val(l)}$(this).css("color",v)}});if(o.val().trim()!=""&&o.val().trim()!=l){o.css("color",F)}x.focus(function(){if($(this).val().trim()==f){$(this).val("")}$(this).css("color",F)}).blur(function(){if($(this).val().trim()==""||$(this).val().trim()==f){if($(this).val().trim()==""){$(this).val(f)}$(this).css("color",v)}});if(x.val().trim()!=""&&x.val().trim()!=f){x.css("color",F)}var j=null;var w=function(I){if(j!=null){clearTimeout(j)}I.siblings("span.orange").html("")};var D=function(I,J){if($("#hidUpdateTime").val()==""){$("ul.info-list").find("span.orange").html("")}else{$("ul.info-list").find("span.orange").not("#span_tip").html("")}if(j!=null){clearTimeout(j)}I.siblings("span.orange").html(J);j=setTimeout(function(){I.siblings("span.orange").html("")},3000)};var n=false;E.bind("click",function(){if(n){return}n=true;var L=m.val().trim();if(L==""||L==C){D(m,"请填写昵称");m.focus();n=false;return}else{if(!p(L)){D(m,"昵称为2-20个字符，汉字、字母、数字、“_-”组成");m.focus();n=false;return}}var O=z.val().trim();if(O!=""&&O!=k){if(!g(O)&&!y(O)){D(z,"请输入正确的备用电话");z.focus();n=false;return}}else{O=""}var W=t();var N=getSelelctVal("sltYear");var X=getSelelctVal("sltMonth");var T=getSelelctVal("sltDay");var K="";if(N!=""&&(X==""||T=="")){D($("#sltDay").parent(),"请选择完整的生日");n=false;return}else{if(N!=""&&X!=""&&T!=""){K=N+"-"+X+"-"+T}}var R=getSelelctVal("sltCons");var Q=getSelelctAreaVal("selLiveB");var P=getSelelctAreaText("selLiveA")+" "+getSelelctAreaText("selLiveB");if(getSelelctAreaVal("selLiveA")!="0"&&Q=="0"){D($("#selLiveB").parent().parent().parent().parent(),"请选择完整的所在地");n=false;return}var U=getSelelctAreaVal("selHomeB");var S=getSelelctAreaText("selHomeA")+" "+getSelelctAreaText("selHomeB");if(getSelelctAreaVal("selHomeA")!="0"&&U=="0"){D($("#selHomeB").parent().parent().parent().parent(),"请选择完整的家乡");n=false;return}var J=o.val().trim();if(J!=""&&J!=l){if(!B(J)){D(o,"请输入正确的QQ号码");o.focus();n=false;return}}else{J=""}var I=getSelelctVal("selMonthIncome");var V=x.val().trim()==f?"":x.val().trim();var M=function(){var Y={action:"updateUserTo",oldUserName:$("#hidOldName").val(),userName:L,userPhone:O,userSex:W,userBirthDay:K,userCons:R,userLiveArea:Q,liveAreaName:P,userBirthArea:U,birthAreaName:S,userQQ:J,userMonthIncome:I,userSign:V,rnd:GetRandomNum(1,10000)};$.post("http://member.1yyg.com/JPData",Y,function(Z){var aa=Z.code;if(aa==0){var ab=Z.num;var ae=parseInt(Z.str);var ad=ae>0?"保存成功，恭喜您获得"+ae+"福分":"保存成功";var ac=ae>0?300:100;if(ab==0){OKDialog(ad,ac,60,function(){location.reload()})}else{if(ab==-9){FailDialog("昵称已存在！")}else{if(ab==-4){FailDialog("昵称不符合网站规范！")}else{if(ab==-2){FailDialog("昵称已存在，请换一个吧！")}else{if(ab==-5){FailDialog("签名不符合规则，再修改一下吧！",300)}else{FailDialog("操作太频繁了，休息一下再来吧！",300)}}}}}}else{if(aa==10){location.reload()}else{if(aa==-4){FailDialog("昵称不符合规则，再修改一下吧！",300)}else{if(aa==-5){FailDialog("签名不符合规则，再修改一下吧！",300)}else{if(aa==-3){FailDialog("昵称不符合规则，再修改一下吧！",300)}else{FailDialog("修改失败,请重试["+aa+"]！")}}}}}n=false},"json")};if($("#hidUpdateTime").val()==""&&K!=""){ShowConfirm("您确认生日信息无误？<br/>保存后一年之内不可修改！？",M,300,165);n=false;return false}else{M()}});if(navigator.userAgent.indexOf("MSIE")>0){if(navigator.userAgent.indexOf("MSIE 7.0")>0||navigator.userAgent.indexOf("MSIE 6.0")>0){var q=$(".info-list").children("li"),A=q.length;q.each(function(){$(this).css({"z-index":A--})})}}};Base.getScript(a+"/Member/JS/SelectControl.js?date=20130123",function(){Base.getScript(a+"/Member/JS/SelectAreaControl.js?date=20130123",b)})});
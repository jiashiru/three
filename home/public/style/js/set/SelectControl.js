$(function(){$.fn.initSelectFun=function(options){var settings={Enabled:false,Value:"",DefTxt:"---请选择---",DataSrouce:null,ClickCallBack:null};options=options||{};$.extend(settings,options);var _SelectObj=$(this).attr("value","");var _DefObj=_SelectObj.children("a");var _ListObj=_SelectObj.children("div.select-state");var setSelectVal=function(obj){closeSelect(obj)};var closeSelect=function(obj){if(obj!=null){obj.addClass("hover").siblings().removeClass("hover");var _gray=obj.html()==settings.DefTxactiont?"gray6":"gray3";_SelectObj.attr("value",obj.attr("value")).removeClass("state-hover").children("a").attr("exp","0").attr("class",_gray).html(obj.html()+'<s class="u-personal"></s></a>')}else{_SelectObj.removeClass("state-hover").children("a").attr("exp","0")}_ListObj.find('a[value=""]').remove()};var showSelect=function(){$("body").trigger("click");if(_SelectObj.attr("value")!=""){var _Def=$('<a href="javascript:;" value="">'+settings.DefTxt+"</a>");_Def.bind("click",function(){setSelectVal($(this))});_ListObj.children("a:first").before(_Def)}_SelectObj.addClass("state-hover").children("a").attr("exp","1")};_DefObj.html(settings.DefTxt+'<s class="u-personal"></s></a>').unbind("click").bind("click",function(e){if(settings.Enabled){return}stopBubble(e);if($(this).attr("exp")=="1"){closeSelect(null)}else{showSelect()}});if(settings.DataSrouce!=null){_ListObj.css("width",_SelectObj.width()).empty();var _listItems;try{_listItems=jQuery.parseJSON(settings.DataSrouce).data}catch(e){_listItems=eval("("+settings.DataSrouce+")").data}var _html="";for(var i=0;i<_listItems.length;i++){_html+='<a href="javascript:;" value="'+_listItems[i].value+'">'+_listItems[i].text+"</a>"}var _ItemObj=$(_html);_ItemObj.bind("click",function(){setSelectVal($(this));if(settings.ClickCallBack!=null){settings.ClickCallBack()}});_ListObj.append(_ItemObj);if(settings.Value!=""){var _item=_ListObj.find("a[value="+settings.Value+"]");if(_item.length>0){_SelectObj.attr("value",settings.Value);_item.addClass("hover");_DefObj.html(_item.html()+'<s class="u-personal"></s>');if(_item.html()!=settings.DefTxt){if(settings.Enabled){_DefObj.attr("class","gray9").attr("style","cursor:default")}else{_DefObj.attr("class","gray3")}}}}$("body").bind("click",function(){closeSelect(null)})}}});function getSelelctVal(a){var b="";var c=$("#"+a);if(c.length>0){b=c.attr("value")}return b}function getSelelctText(a){var b="";var c=$("#"+a);if(c.attr("value")!=""){b=c.children("div.select-state").find("a[value="+c.attr("value")+"]").html()}return b};
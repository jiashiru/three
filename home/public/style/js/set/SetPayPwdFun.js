$(function(){var h=$("#hidStr").val();var m=$("#txtPwd1");var f=$("#txtPwd2");var j=$("#div_tips");var p=m.next("strong");var n=$("#btnSubmit");var i="",g="";var k=/^\d+$/,q=/^\d{6}$/;var c=false;var a=null;var d=function(r){clearTimeout(a);if(r==""){j.html("").hide()}else{j.html('<div class="form-orange-tips">'+r+"</div>").show();a=setTimeout(function(){j.html("")},3000)}return false};var b=function(r){if(r==0){n.removeClass("gray-btn")}else{n.addClass("gray-btn")}};var l="#333333",o="#bbbbbb";m.keyup(function(){var s=m.val().trim();if(!k.test(s)){var r=window.event?event.keyCode:e.keyCode;if(r!=8&&r!=46){i=/^\d+/.exec(s);m.val(i)}}else{i=s}}).blur(function(){var r=m.val().trim();if(r==""){p.show()}else{if(!q.test(r)){d("支付密码为6位纯数字")}else{c=false;GetJPData("","sc_CheckPayPwd","payPwd="+r,function(s){if(s.code==0){c=true;i=r;b(0);d("")}else{if(s.code==1){b(1);d("不能与登录密码一致");c=false}else{if(s.code==2){b(1);d("新密码不能与原密码一致");c=false}else{if(s.code==10){location.reload()}}}}})}}}).focus(function(){d("");$(this).css("color",l)});p.click(function(){p.hide();m.focus()});f.keyup(function(){var s=f.val().trim();if(!k.test(s)){var r=window.event?event.keyCode:e.keyCode;if(r!=8&&r!=46){g=/^\d+/.exec(s);f.val(g)}}else{g=s}}).blur(function(){var r=f.val().trim();var s=m.val().trim();if(r==""){if(q.test(s)){d("请输入确认密码")}}else{if(!q.test(r)){d("支付密码为6位纯数字")}else{if(q.test(s)){if(s!=r){d("两次密码不一致")}else{g=r;d("")}}}}}).focus(function(){d("");$(this).css("color",l)});n.click(function(){if(!c||$(this).hasClass("gray-btn")){return}var t=m.val().trim();var s=f.val().trim();var u=false,r=false;if(t==""){d("请输入6位纯数字支付密码");return false}else{if(!q.test(t)){d("支付密码为6位纯数字");return false}else{u=true}}if(s==""){d("请输入确认密码");return false}else{if(!q.test(t)){d("支付密码为6位纯数字");return false}else{if(q.test(t)&&t!=s){d("两次密码不一致");return false}else{r=true}}}if(u&&r){GetJPData("","sc_SetPayPwd","payPwd="+s+"&str="+h,function(w){if(w.code==0){var v=$("#hidForward").val();if(v==""){v="/security/index.do"}OKDialog("设置成功",160,60,function(){location.replace(v)})}else{if(w.code==2&&w.num==-4){FailDialog("新密码不能与原密码一致",240)}else{FailDialog("设置失败")}}})}return false})});